#!/bin/sh

if [ -z "$FBTERM_TTY" ]; then
	echo '$FBTERM_TTY is not set.'
	exit 1
fi

if [ ! -c "$FBTERM_TTY" ]; then
	echo "$FBTERM_TTY does not exist."
	exit 1
fi

if [ -f /etc/fbtermbg ]; then
	FBTERM_BACKGROUND=$(cat /etc/fbtermbg 2>&1)
	if [ -f "$FBTERM_BACKGROUND" ]; then
		export FBTERM_BACKGROUND_IMAGE=1
	fi
fi

exec fbterm "$@" -- /usr/libexec/fbterm-login < "$FBTERM_TTY" > "$FBTERM_TTY" 2>&1
